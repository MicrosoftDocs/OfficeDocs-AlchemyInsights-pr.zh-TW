---
title: 疑難排解 OAuth 2.0 和 OpenID Connect 通訊協定
ms.author: v-smandalika
author: v-smandalika
manager: dansimp
ms.date: 03/17/2021
audience: Admin
ms.topic: article
ms.service: o365-administration
ROBOTS: NOINDEX, NOFOLLOW
localization_priority: Priority
ms.collection: Adm_O365
ms.custom:
- "9776"
- "9004342"
ms.openlocfilehash: d2f14d4d16bea890b564cdb9bd9ac3875c28d115
ms.sourcegitcommit: c08bed4071baa3bb5879496df3ed44fb828c8367
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/19/2021
ms.locfileid: "50897807"
---
# <a name="troubleshoot-oauth-20-and-openid-connect-protocols"></a><span data-ttu-id="ee985-102">疑難排解 OAuth 2.0 和 OpenID Connect 通訊協定</span><span class="sxs-lookup"><span data-stu-id="ee985-102">Troubleshoot OAuth 2.0 and OpenID Connect protocols</span></span>

<span data-ttu-id="ee985-103">若要解決 OAuth 2.0 和 OpenID Connect 問題，請執行下列建議步驟：</span><span class="sxs-lookup"><span data-stu-id="ee985-103">To resolve OAuth 2.0 and OpenID Connect issues, perform the following recommended steps:</span></span>

<span data-ttu-id="ee985-104">請參閱下列與 OAuth 2.0 和 OpenID Connect 通訊協定之組態和疑難排解的相關文章：</span><span class="sxs-lookup"><span data-stu-id="ee985-104">Refer to the following articles that are related to configuration and troubleshooting OAuth 2.0 and OpenID Connect protocols:</span></span>

- <span data-ttu-id="ee985-105">[Microsoft 身分識別平台和 OAuth 2.0 授權碼流程](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-auth-code-flow) (部分機器翻譯) - 本文說明如何使用任何語言直接對應用程式中的 **程式碼授權 (PKCE) 流程** 進行程式設計。</span><span class="sxs-lookup"><span data-stu-id="ee985-105">[Microsoft identity platform and OAuth 2.0 authorization code flow](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-auth-code-flow) - This article describes how to program directly against the **code grant (PKCE) flow** in your application, using any language.</span></span>
- <span data-ttu-id="ee985-106">[Microsoft 身分識別平台和 OAuth 2.0 用戶端認證流程](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow) (部分機器翻譯) - 本文說明如何直接對應用程式中的 **用戶端認證流程** 進行程式設計。</span><span class="sxs-lookup"><span data-stu-id="ee985-106">[Microsoft identity platform and the OAuth 2.0 client credentials flow](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow) - This article describes how to program directly against the **client credentials flow** in your application.</span></span>
- <span data-ttu-id="ee985-107">[Microsoft 身分識別平台和 OAuth 2.0 資源擁有者密碼認證](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth-ropc) (部分機器翻譯) - 本文說明如何直接對應用程式中的 **ROPC 流程** 進行程式設計。</span><span class="sxs-lookup"><span data-stu-id="ee985-107">[Microsoft identity platform and OAuth 2.0 Resource Owner Password Credentials](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth-ropc) - This article describes how to program directly against the **ROPC flow** in your application.</span></span>
    - <span data-ttu-id="ee985-108">Microsoft 身分識別平台僅支援適用於 Azure AD 租用戶 (而非個人帳戶) 的 ROPC。</span><span class="sxs-lookup"><span data-stu-id="ee985-108">The Microsoft identity platform only supports ROPC for Azure AD tenants, and not for personal accounts.</span></span> <span data-ttu-id="ee985-109">這表示您必須使用租用戶特定的端點 **(https://login.microsoftonline.com/{TenantId_or_Name})** 或 **組織** 端點。</span><span class="sxs-lookup"><span data-stu-id="ee985-109">This means that you must use a tenant-specific endpoint **(https://login.microsoftonline.com/{TenantId_or_Name})** or the **organizations** endpoint.</span></span>
    - <span data-ttu-id="ee985-110">受邀加入 Azure AD 租用戶的個人帳戶無法使用 ROPC。</span><span class="sxs-lookup"><span data-stu-id="ee985-110">Personal accounts that are invited to an Azure AD tenant can't use ROPC.</span></span>
    - <span data-ttu-id="ee985-111">沒有密碼的帳戶無法透過 ROPC 進行登入。</span><span class="sxs-lookup"><span data-stu-id="ee985-111">Accounts that don't have passwords can't sign in through ROPC.</span></span> <span data-ttu-id="ee985-112">針對此案例，建議您改為針對應用程式使用不同的流程。</span><span class="sxs-lookup"><span data-stu-id="ee985-112">For this scenario, we recommend that you use a different flow for your app, instead.</span></span>
    - <span data-ttu-id="ee985-113">如果使用者需要[多重要素驗證 (MFA)](https://docs.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks) (部分機器翻譯) 登入應用程式，他們將被封鎖。</span><span class="sxs-lookup"><span data-stu-id="ee985-113">If users need to use [multi-factor authentication (MFA)](https://docs.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks) to log in to the application, they will be blocked.</span></span>
    - <span data-ttu-id="ee985-114">在[混合式識別身分同盟](https://docs.microsoft.com/azure/active-directory/hybrid/whatis-fed) (部分機器翻譯) 案例 (例如，用來驗證內部部署帳戶的 Azure AD 和 ADFS) 中不支援 ROPC。</span><span class="sxs-lookup"><span data-stu-id="ee985-114">ROPC is not supported in [hybrid identity federation](https://docs.microsoft.com/azure/active-directory/hybrid/whatis-fed) scenarios (for example, Azure AD and ADFS used to authenticate on-premises accounts).</span></span> <span data-ttu-id="ee985-115">如果使用者全頁重新導向至內部部署身分識別提供者，Azure AD 無法針對該身分識別提供者測試使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="ee985-115">If users are full-page redirected to an on-premises identity provider, Azure AD is not able to test the username and password against that identity provider.</span></span> <span data-ttu-id="ee985-116">不過，[傳遞驗證](https://docs.microsoft.com/azure/active-directory/hybrid/how-to-connect-pta) (部分機器翻譯) 支援 ROPC。</span><span class="sxs-lookup"><span data-stu-id="ee985-116">[Pass-through authentication](https://docs.microsoft.com/azure/active-directory/hybrid/how-to-connect-pta) is supported with ROPC, however.</span></span>
    - <span data-ttu-id="ee985-117">混合式識別身分同盟案例的例外如下：將 **AllowCloudPasswordValidation** 的主領域探索原則設定為 **TRUE**，當內部部署密碼同步處理至雲端時，讓 ROPC 流程對同盟使用者有效。</span><span class="sxs-lookup"><span data-stu-id="ee985-117">An exception to a hybrid identity federation scenario would be the following: Home Realm Discovery policy with **AllowCloudPasswordValidation** set to **TRUE** will enable ROPC flow to work for federated users when on-premises password is synced to cloud.</span></span> <span data-ttu-id="ee985-118">如需詳細資訊，請參閱[針對舊版應用程式啟用同盟使用者的直接 ROPC 驗證](https://docs.microsoft.com/azure/active-directory/manage-apps/configure-authentication-for-federated-users-portal#enable-direct-ropc-authentication-of-federated-users-for-legacy-applications) (部分機器翻譯)</span><span class="sxs-lookup"><span data-stu-id="ee985-118">For more information, see [Enable direct ROPC authentication of federated users for legacy applications](https://docs.microsoft.com/azure/active-directory/manage-apps/configure-authentication-for-federated-users-portal#enable-direct-ropc-authentication-of-federated-users-for-legacy-applications)</span></span> 
- <span data-ttu-id="ee985-119">[Microsoft 身分識別平台和 OAuth 2.0 代理者流程](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow) (部分機器翻譯) - 本文說明如何直接對應用程式中的 **代理者 (OBO) 流程** 進行程式設計。</span><span class="sxs-lookup"><span data-stu-id="ee985-119">[Microsoft identity platform and OAuth 2.0 On-Behalf-Of flow](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow) - This article describes how to program directly against the **on-behalf-of (OBO) flow** in your application.</span></span>
- <span data-ttu-id="ee985-120">[Microsoft 身分識別平台和 OpenID Connect 通訊協定](https://docs.microsoft.com/azure/active-directory/develop/v2-protocols-oidc) (部分機器翻譯) - 本文說明如何獨立於語言來實作 OpenID Connect 通訊協定，並說明如何在不使用任何 Microsoft 開放原始碼程式庫的情況下傳送和接收 HTTP 訊息。</span><span class="sxs-lookup"><span data-stu-id="ee985-120">[Microsoft identity platform and OpenID Connect protocol](https://docs.microsoft.com/azure/active-directory/develop/v2-protocols-oidc) - This article shows how to implement the OpenID Connect protocol independent of language, and describes how to send and receive HTTP messages without using any Microsoft open-source libraries.</span></span>

<span data-ttu-id="ee985-121">**存取權杖**</span><span class="sxs-lookup"><span data-stu-id="ee985-121">**Access Tokens**</span></span>

<span data-ttu-id="ee985-122">[Microsoft 身分識別平台存取權杖](https://docs.microsoft.com/azure/active-directory/develop/access-tokens) (部分機器翻譯) - 了解 API 如何驗證和使用存取權杖內的宣告。</span><span class="sxs-lookup"><span data-stu-id="ee985-122">[Microsoft identity platform access tokens](https://docs.microsoft.com/azure/active-directory/develop/access-tokens) - Learn how your API can validate and use the claims inside an access token.</span></span> <span data-ttu-id="ee985-123">本文中的所有文件 (除非有說明)，僅適用於針對您註冊的 API 所發行的權杖。</span><span class="sxs-lookup"><span data-stu-id="ee985-123">All documentation in this article, except where noted, applies only to tokens issued for APIs you've registered.</span></span> <span data-ttu-id="ee985-124">它不適用於針對 Microsoft 擁有的 API 所發行的權杖，也無法使用這些權杖來驗證 Microsoft 身分識別平台如何針對您建立的 API 發行權杖。</span><span class="sxs-lookup"><span data-stu-id="ee985-124">It does not apply to tokens issued for Microsoft-owned APIs, nor can those tokens be used to validate how the Microsoft identity platform will issue tokens for an API you create.</span></span>

<span data-ttu-id="ee985-125">**應用程式設定**</span><span class="sxs-lookup"><span data-stu-id="ee985-125">**Application Configuration**</span></span>

<span data-ttu-id="ee985-126">[重新導向 URI (回覆 URL) 限制](https://docs.microsoft.com/azure/active-directory/develop/reply-url) (部分機器翻譯) - 了解如何設定重新導向 URI (回覆 URL)。</span><span class="sxs-lookup"><span data-stu-id="ee985-126">[Redirect URI (reply URL) restrictions and limitations](https://docs.microsoft.com/azure/active-directory/develop/reply-url) - Learn how to configure your Redirect URI (reply URL).</span></span> <span data-ttu-id="ee985-127">重新導向 URI 或回覆 URL 是授權伺服器成功授權應用程式並授與授權碼或存取權杖後，傳送使用者的位置。</span><span class="sxs-lookup"><span data-stu-id="ee985-127">A redirect URI, or reply URL, is the location where the authorization server sends the user once the app has been successfully authorized and granted an authorization code or access token.</span></span> <span data-ttu-id="ee985-128">授權伺服器會將代碼或權杖傳送至重新導向 URI；因此，您必須在應用程式註冊過程中註冊正確的位置。</span><span class="sxs-lookup"><span data-stu-id="ee985-128">The authorization server sends the code or token to the redirect URI; so it's important you register the correct location as part of the app registration process.</span></span>

<span data-ttu-id="ee985-129">**應用程式佈建**</span><span class="sxs-lookup"><span data-stu-id="ee985-129">**Application Provisioning**</span></span>

<span data-ttu-id="ee985-130">[教學課程：針對 SCIM 端點進行開發和規劃佈建](https://docs.microsoft.com/azure/active-directory/app-provisioning/use-scim-to-provision-users-and-groups) (部分機器翻譯) - 本文說明如何建立 SCIM 端點，並與 AAD 佈建服務整合。</span><span class="sxs-lookup"><span data-stu-id="ee985-130">[Tutorial: Develop and plan provisioning for a SCIM endpoint](https://docs.microsoft.com/azure/active-directory/app-provisioning/use-scim-to-provision-users-and-groups) - This article describes how to build an SCIM endpoint and integrate with the AAD provisioning service.</span></span>


